# Модуль LLM-Сервисов (с функцией прогнозирования)

Этот модуль предоставляет гибкую архитектуру для работы с различными моделями большого языка (LLM), включая анализ настроений и прогнозирование временных рядов.

## Архитектура

Основная логика находится в файле `index.ts`, который экспортирует две основные функции:

1.  **`analyzeNews(articles)`**: Функция для анализа тональности новостей.
    - Она реализует механизм отката (fallback), последовательно обращаясь к провайдерам: **OpenRouter** → **Ollama** → **Gemini**.
    - Если один сервис недоступен, система автоматически переключается на следующий.

2.  **`generatePriceForecast(ticker, stockData, analyzedNews)`**: Функция для генерации прогноза цен.
    - **Важно:** В настоящее время эту сложную задачу выполняет только **Gemini** (`generateForecastWithGemini`).
    - Архитектура позволяет в будущем добавить аналогичные функции для других провайдеров и встроить их в общую логику отката.

## Конфигурация

Для работы модуля необходимо задать переменные окружения в файле `.env.local` в корневой директории `ux llm/`.

-   `OPENROUTER_API_KEY`: Ключ для OpenRouter.
-   `GEMINI_API_KEY`: Ключ для Google Gemini.
-   `OLLAMA_HOST`: (Опционально) URL для локального сервера Ollama (по умолчанию `http://localhost:11434`).
-   `GEMINI_MODEL`, `OPENROUTER_MODEL`, `OLLAMA_MODEL`: (Опционально) для указания конкретных моделей.

## Расширение

### Добавление нового провайдера для анализа новостей:
1.  Создайте файл `newProvider.ts` в этой директории.
2.  Реализуйте в нем функцию `analyzeNewsWithNewProvider`.
3.  Добавьте вызов этой функции в цепочку `try...catch` в `index.ts`.

### Добавление нового провайдера для прогнозирования:
1.  В файле вашего провайдера (например, `openrouter.ts`) реализуйте функцию `generateForecastWithOpenRouter`.
2.  В `index.ts` добавьте логику отката для `generatePriceForecast`, чтобы она вызывала вашу новую функцию в случае неудачи основного провайдера.
